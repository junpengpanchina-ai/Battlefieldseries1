<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡èµ„æºæµ‹è¯• - æˆ˜åœ°ç³»åˆ—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f5f7fa;
            color: #2a2a2a;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            color: white;
            padding: 40px 0;
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #ff6b35;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .status-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .status-card h3 {
            color: #ff6b35;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }

        .status-indicator.error {
            background: #dc3545;
        }

        .status-indicator.warning {
            background: #ffc107;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .image-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .category-section {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .category-header {
            background: #ff6b35;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .category-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .image-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .image-item {
            position: relative;
            aspect-ratio: 16/9;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            transition: all 0.3s;
        }

        .image-item:hover {
            border-color: #ff6b35;
            transform: translateY(-2px);
        }

        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s;
        }

        .image-item.loading img {
            opacity: 0.5;
        }

        .image-item.error {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .image-item.success {
            border-color: #28a745;
        }

        .image-status {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: white;
            font-weight: bold;
        }

        .image-status.loading {
            background: #ffc107;
        }

        .image-status.success {
            background: #28a745;
        }

        .image-status.error {
            background: #dc3545;
        }

        .image-filename {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px;
            font-size: 0.75rem;
            text-align: center;
        }

        .controls {
            text-align: center;
            margin: 40px 0;
        }

        .btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background: #e55a2b;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .config-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .config-section h3 {
            color: #ff6b35;
            margin-bottom: 20px;
        }

        .config-item {
            margin-bottom: 15px;
        }

        .config-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2a2a2a;
        }

        .config-item input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
        }

        .config-item input:focus {
            outline: none;
            border-color: #ff6b35;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ff6b35;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>ğŸ–¼ï¸ å›¾ç‰‡èµ„æºæµ‹è¯•</h1>
            <p>éªŒè¯äº‘å­˜å‚¨æ¥å£è¿æ¥å’Œå›¾ç‰‡åŠ è½½çŠ¶æ€</p>
        </div>
    </div>

    <div class="container">
        <!-- é…ç½®åŒºåŸŸ -->
        <div class="config-section">
            <h3>ğŸ“‹ æ¥å£é…ç½®</h3>
            <div class="config-item">
                <label for="apiUrl">äº‘å­˜å‚¨APIåœ°å€</label>
                <input type="url" id="apiUrl" value="https://2776117bb412e09a1d30cbe886cd3935.r2.cloudflarestorage.com/battlefieldseries2042" readonly>
            </div>
            <div class="alert alert-info">
                <strong>å½“å‰é…ç½®ï¼š</strong> ä½¿ç”¨Cloudflare R2å­˜å‚¨ï¼ŒåŸºç¡€è·¯å¾„å·²è®¾ç½®ã€‚å¦‚éœ€ä¿®æ”¹é…ç½®ï¼Œè¯·è”ç³»å¼€å‘äººå‘˜ã€‚
            </div>
        </div>

        <!-- çŠ¶æ€æ¦‚è§ˆ -->
        <div class="status-grid">
            <div class="status-card">
                <h3><div class="status-indicator" id="apiStatus"></div> APIè¿æ¥çŠ¶æ€</h3>
                <p id="apiStatusText">æ£€æµ‹ä¸­...</p>
            </div>
            <div class="status-card">
                <h3><div class="status-indicator" id="imageStatus"></div> å›¾ç‰‡åŠ è½½çŠ¶æ€</h3>
                <p id="imageStatusText">ç­‰å¾…æµ‹è¯•...</p>
            </div>
            <div class="status-card">
                <h3><div class="status-indicator success"></div> å›¾ç‰‡ç®¡ç†å™¨</h3>
                <p>å·²é›†æˆåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ”¯æŒè‡ªåŠ¨é™çº§</p>
            </div>
        </div>

        <!-- æ§åˆ¶æŒ‰é’® -->
        <div class="controls">
            <button class="btn" onclick="testAllImages()">
                <span class="loading-spinner" id="testSpinner" style="display: none;"></span>
                å¼€å§‹æµ‹è¯•æ‰€æœ‰å›¾ç‰‡
            </button>
            <button class="btn btn-secondary" onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
            <button class="btn btn-secondary" onclick="exportResults()">å¯¼å‡ºæŠ¥å‘Š</button>
        </div>

        <!-- å›¾ç‰‡åˆ†ç±»æµ‹è¯• -->
        <div id="imageTestResults">
            <!-- UIå›¾ç‰‡ -->
            <div class="category-section">
                <div class="category-header">
                    <h3>ğŸ¨ UIå›¾ç‰‡ (Logoã€å›¾æ ‡ç­‰)</h3>
                </div>
                <div class="image-grid" id="uiImages"></div>
            </div>

            <!-- èƒŒæ™¯å›¾ç‰‡ -->
            <div class="category-section">
                <div class="category-header">
                    <h3>ğŸŒ… èƒŒæ™¯å›¾ç‰‡</h3>
                </div>
                <div class="image-grid" id="backgroundImages"></div>
            </div>

            <!-- æ¸¸æˆæˆªå›¾ -->
            <div class="category-section">
                <div class="category-header">
                    <h3>ğŸ® æ¸¸æˆæˆªå›¾</h3>
                </div>
                <div class="image-grid" id="gameImages"></div>
            </div>

            <!-- æ–°é—»é…å›¾ -->
            <div class="category-section">
                <div class="category-header">
                    <h3>ğŸ“° æ–°é—»é…å›¾</h3>
                </div>
                <div class="image-grid" id="newsImages"></div>
            </div>
        </div>
    </div>

    <script>
        // å›¾ç‰‡æµ‹è¯•é…ç½®
        const IMAGE_CONFIG = {
            baseUrl: 'https://2776117bb412e09a1d30cbe886cd3935.r2.cloudflarestorage.com/battlefieldseries2042',
            categories: {
                ui: ['logo.png', 'favicon.ico'],
                backgrounds: ['hero-bg.jpg', 'news-bg.jpg', 'games-bg.jpg', 'media-bg.jpg'],
                games: [
                    'bf2042.jpg', 'bf2042-screenshot-1.jpg', 'bf2042-screenshot-2.jpg', 'bf2042-screenshot-3.jpg', 'bf2042-screenshot-4.jpg',
                    'bfv.jpg', 'bfv-screenshot-1.jpg', 'bfv-screenshot-2.jpg', 'bfv-screenshot-3.jpg',
                    'bf1.jpg', 'bf1-screenshot-1.jpg', 'bf1-screenshot-2.jpg', 'bf1-screenshot-3.jpg',
                    'bf4.jpg', 'bf4-screenshot-1.jpg', 'bf4-screenshot-2.jpg', 'bf4-screenshot-3.jpg'
                ],
                news: [
                    'update-s5.jpg', 'new-year-event.jpg', 'community-feedback.jpg',
                    'developer-interview.jpg', 'esports-league.jpg', 'mobile-update.jpg'
                ]
            }
        };

        let testResults = {
            total: 0,
            success: 0,
            error: 0,
            details: {}
        };

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            setupImageContainers();
            testApiConnection();
        });

        // è®¾ç½®å›¾ç‰‡å®¹å™¨
        function setupImageContainers() {
            Object.keys(IMAGE_CONFIG.categories).forEach(category => {
                const container = document.getElementById(category + 'Images');
                if (container) {
                    IMAGE_CONFIG.categories[category].forEach(filename => {
                        const imageItem = createImageItem(category, filename);
                        container.appendChild(imageItem);
                    });
                }
            });
        }

        // åˆ›å»ºå›¾ç‰‡é¡¹ç›®
        function createImageItem(category, filename) {
            const item = document.createElement('div');
            item.className = 'image-item loading';
            item.id = `img-${category}-${filename.replace(/[^a-zA-Z0-9]/g, '-')}`;
            
            const img = document.createElement('img');
            img.alt = filename;
            img.style.display = 'none';
            
            const status = document.createElement('div');
            status.className = 'image-status loading';
            status.textContent = 'â³';
            
            const filename_div = document.createElement('div');
            filename_div.className = 'image-filename';
            filename_div.textContent = filename;
            
            item.appendChild(img);
            item.appendChild(status);
            item.appendChild(filename_div);
            
            return item;
        }

        // æµ‹è¯•APIè¿æ¥
        async function testApiConnection() {
            const statusIndicator = document.getElementById('apiStatus');
            const statusText = document.getElementById('apiStatusText');
            
            try {
                // å°è¯•åŠ è½½ä¸€ä¸ªæµ‹è¯•å›¾ç‰‡æ¥éªŒè¯è¿æ¥
                const testUrl = `${IMAGE_CONFIG.baseUrl}/ui/logo.png`;
                const response = await fetch(testUrl, { method: 'HEAD' });
                
                if (response.ok) {
                    statusIndicator.className = 'status-indicator success';
                    statusText.textContent = 'APIè¿æ¥æ­£å¸¸ï¼Œå¯ä»¥è®¿é—®äº‘å­˜å‚¨èµ„æº';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                statusIndicator.className = 'status-indicator error';
                statusText.textContent = `è¿æ¥å¤±è´¥: ${error.message}`;
            }
        }

        // æµ‹è¯•æ‰€æœ‰å›¾ç‰‡
        async function testAllImages() {
            const spinner = document.getElementById('testSpinner');
            const statusIndicator = document.getElementById('imageStatus');
            const statusText = document.getElementById('imageStatusText');
            
            spinner.style.display = 'inline-block';
            statusIndicator.className = 'status-indicator warning';
            statusText.textContent = 'æ­£åœ¨æµ‹è¯•å›¾ç‰‡åŠ è½½...';
            
            // é‡ç½®ç»“æœ
            testResults = { total: 0, success: 0, error: 0, details: {} };
            
            // æµ‹è¯•æ‰€æœ‰åˆ†ç±»çš„å›¾ç‰‡
            for (const [category, files] of Object.entries(IMAGE_CONFIG.categories)) {
                testResults.details[category] = {};
                
                for (const filename of files) {
                    testResults.total++;
                    await testSingleImage(category, filename);
                }
            }
            
            // æ›´æ–°æ€»ä½“çŠ¶æ€
            spinner.style.display = 'none';
            if (testResults.error === 0) {
                statusIndicator.className = 'status-indicator success';
                statusText.textContent = `æ‰€æœ‰${testResults.total}å¼ å›¾ç‰‡åŠ è½½æˆåŠŸï¼`;
            } else if (testResults.success > 0) {
                statusIndicator.className = 'status-indicator warning';
                statusText.textContent = `${testResults.success}/${testResults.total}å¼ å›¾ç‰‡åŠ è½½æˆåŠŸ`;
            } else {
                statusIndicator.className = 'status-indicator error';
                statusText.textContent = `æ‰€æœ‰${testResults.total}å¼ å›¾ç‰‡åŠ è½½å¤±è´¥`;
            }
        }

        // æµ‹è¯•å•å¼ å›¾ç‰‡
        async function testSingleImage(category, filename) {
            const itemId = `img-${category}-${filename.replace(/[^a-zA-Z0-9]/g, '-')}`;
            const item = document.getElementById(itemId);
            const img = item.querySelector('img');
            const status = item.querySelector('.image-status');
            
            const imageUrl = `${IMAGE_CONFIG.baseUrl}/${category}/${filename}`;
            
            return new Promise((resolve) => {
                const testImg = new Image();
                
                testImg.onload = () => {
                    // åŠ è½½æˆåŠŸ
                    item.className = 'image-item success';
                    status.className = 'image-status success';
                    status.textContent = 'âœ“';
                    img.src = imageUrl;
                    img.style.display = 'block';
                    
                    testResults.success++;
                    testResults.details[category][filename] = 'success';
                    resolve();
                };
                
                testImg.onerror = () => {
                    // åŠ è½½å¤±è´¥
                    item.className = 'image-item error';
                    status.className = 'image-status error';
                    status.textContent = 'âœ—';
                    
                    testResults.error++;
                    testResults.details[category][filename] = 'error';
                    resolve();
                };
                
                // è®¾ç½®è¶…æ—¶
                setTimeout(() => {
                    if (!testImg.complete) {
                        item.className = 'image-item error';
                        status.className = 'image-status error';
                        status.textContent = 'â°';
                        
                        testResults.error++;
                        testResults.details[category][filename] = 'timeout';
                        resolve();
                    }
                }, 10000);
                
                testImg.src = imageUrl;
            });
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            document.querySelectorAll('.image-item').forEach(item => {
                item.className = 'image-item loading';
                const img = item.querySelector('img');
                const status = item.querySelector('.image-status');
                
                img.style.display = 'none';
                img.src = '';
                status.className = 'image-status loading';
                status.textContent = 'â³';
            });
            
            const statusIndicator = document.getElementById('imageStatus');
            const statusText = document.getElementById('imageStatusText');
            statusIndicator.className = 'status-indicator';
            statusText.textContent = 'ç­‰å¾…æµ‹è¯•...';
            
            testResults = { total: 0, success: 0, error: 0, details: {} };
        }

        // å¯¼å‡ºæµ‹è¯•æŠ¥å‘Š
        function exportResults() {
            if (testResults.total === 0) {
                alert('è¯·å…ˆè¿è¡Œå›¾ç‰‡æµ‹è¯•');
                return;
            }
            
            const report = {
                timestamp: new Date().toISOString(),
                baseUrl: IMAGE_CONFIG.baseUrl,
                summary: {
                    total: testResults.total,
                    success: testResults.success,
                    error: testResults.error,
                    successRate: ((testResults.success / testResults.total) * 100).toFixed(2) + '%'
                },
                details: testResults.details
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `image-test-report-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html> 